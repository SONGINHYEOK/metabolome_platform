# 시연 튜토리얼 (Step-by-Step)

> DEMO_SCENARIO.md의 각 씬을 실제로 수행하기 위한 실전 가이드입니다.
> 처음 세팅하는 사람도 이 문서만 따라하면 시연 준비가 완료됩니다.

---

## 0. 사전 준비

### 0-1. 환경 요구사항

| 항목 | 요구사항 |
|------|----------|
| Python | 3.10 이상 |
| OS | macOS / Linux / Windows |
| 브라우저 | Chrome 권장 (Full HD 1920x1080) |
| 네트워크 | Groq AI API 호출을 위해 인터넷 연결 필요 |

### 0-2. 최초 설치 (한 번만)

```bash
# 1) 프로젝트 폴더로 이동
cd /Users/song-inhyeog/Documents/metabolome_platform

# 2) 패키지 설치
pip install -r requirements.txt

# 3) DB 마이그레이션
python manage.py migrate

# 4) 샘플 데이터 시딩
python manage.py seed_data
```

### 0-3. Groq API 키 확인

`config/settings.py` 하단에 아래 설정이 있는지 확인합니다:

```python
GROQ_API_KEY = os.environ.get('GROQ_API_KEY', 'gsk_...')  # 키가 들어있어야 함
GROQ_MODEL = os.environ.get('GROQ_MODEL', 'llama-3.3-70b-versatile')
```

> API 키가 비어있으면 AI 기능(챗봇, 성분 해석, 대시보드 해설)이 작동하지 않습니다.
> Groq 무료 키는 https://console.groq.com 에서 발급받을 수 있습니다.

### 0-4. 서버 실행

```bash
python manage.py runserver 6321
```

브라우저에서 http://127.0.0.1:6321/ 접속하여 랜딩페이지가 보이면 준비 완료입니다.

### 0-5. 외부 접속 링크 (선택사항)

외부에서 접속이 필요하면 Cloudflare 터널을 사용합니다:

```bash
# cloudflared 설치 (macOS)
brew install cloudflared

# 터널 실행
nohup cloudflared tunnel --url http://127.0.0.1:6321 > /tmp/cloudflared.log 2>&1 &

# 생성된 URL 확인
grep -oE "https://[a-z0-9-]+\.trycloudflare\.com" /tmp/cloudflared.log | head -1
```

출력된 `https://xxx.trycloudflare.com` URL로 외부 접속 가능합니다.

---

## 1. 녹화 환경 세팅

### 브라우저 준비
1. Chrome을 열고 **전체화면**(F11) 또는 **탭만 표시** 모드로 전환
2. 주소창에 `http://127.0.0.1:6321/` 입력
3. 화면 해상도 **1920x1080** 확인
4. 북마크바, 개발자 도구 등 불필요한 UI 숨기기

### 녹화 도구
- **macOS**: `Cmd + Shift + 5` → "화면 기록" 또는 "선택 영역 기록"
- **OBS Studio**: 소스 → "윈도우 캡처" → Chrome 창 선택

### 사전 체크리스트
- [ ] 서버 실행 중 (`python manage.py runserver 6321`)
- [ ] 랜딩페이지 정상 표시 확인
- [ ] AI 챗봇 버튼 (우하단 파란 원) 보이는지 확인
- [ ] Catalog 페이지에서 성분 클릭 시 AI 해석 로딩되는지 확인
- [ ] Dashboard 페이지에서 우측 AI 패널 로딩되는지 확인

---

## 2. Scene별 튜토리얼

---

### Scene 1. 도입 (30초)

**URL**: `http://127.0.0.1:6321/`

**해야 할 것**:

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 랜딩페이지 전체를 2~3초 보여줌 | 타이틀, 설명 텍스트 보임 |
| 2 | 마우스를 상단 수치 카드로 천천히 이동 | **80종** → **50종** → **2-Track** 카드 순서대로 |
| 3 | 하단 2-Track 카드에 마우스 호버 | 카드가 살짝 올라가는 애니메이션 |
| 4 | **RESEARCH PORTAL** 카드 클릭 | `/research/` 페이지로 이동 |

**주의**: "PUBLIC PORTAL"은 클릭하지 마세요. Scene 4에서 갑니다.

---

### Scene 2. 연구자 포털 메인 (20초)

**URL**: `http://127.0.0.1:6321/research/`

**해야 할 것**:

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 네이비 헤더, 브레드크럼 잠깐 보여줌 | "RESEARCH PORTAL" 헤더 확인 |
| 2 | Quick Stats 카드 영역 강조 | 등록 성분 수, 분석 작물 수 표시 |
| 3 | 4개 기능 카드 중 **Compound Catalog** 클릭 | **ACTIVE** 배지가 있는 첫 번째 카드 |

**팁**: "개발 예정" 카드(원산지 판별, 표준 데이터 패키지, QC 검증)는 마우스로 스쳐 지나가기만 하세요.

---

### Scene 3. Compound Catalog — 핵심 시연 (1분 30초)

**URL**: `http://127.0.0.1:6321/research/catalog/`

#### 동작 1 — 전체 레이아웃 확인 (15초)

페이지 진입하면 **자동으로 첫 번째 성분이 선택**됩니다.

| 확인 사항 | 위치 |
|-----------|------|
| 좌측: 필터 패널 (작목, 부위, 산지, 연도, QC) | 좌측 사이드바 |
| 중앙: 성분 목록 (파란색 테두리 = 선택됨) | 메인 영역 |
| 우측: 상세 정보 패널 | 우측 사이드바 |

마우스를 좌 → 중 → 우 순서로 천천히 이동하여 3-컬럼 구조를 보여주세요.

#### 동작 2 — 필터링 시연 (20초)

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 좌측 **작목(CROP)** 드롭다운에서 **"인삼"** 선택 | 목록이 자동 갱신됨 (인삼 성분만 표시) |
| 2 | 상단 건수 확인 | "총 16건 중 **4개** 표시" 등으로 변경 |
| 3 | 좌측 하단 **"초기화"** 링크 클릭 | 전체 목록 복원 |

#### 동작 3 — 성분 선택 (20초)

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 중앙 목록에서 **Ginsenoside Rg1** 클릭 | 행이 파란 테두리로 하이라이트, 우측 패널 갱신 |
| 2 | 우측 상단 확인 | 성분명 "Ginsenoside Rg1" + **L1** 초록 배지 |
| 3 | 메타 정보 그리드 확인 | 작목: 인삼, 부위: 뿌리, 산지: 금산, 연도: 2025 |
| 4 | IN-HOUSE 배지, Score 96, Similarity 0.94 확인 | 우측 패널 내 |

#### 동작 4 — 상세 분석 (25초)

우측 패널을 아래로 스크롤합니다:

| 순서 | 영역 | 확인 사항 |
|------|------|-----------|
| 1 | 활용모델 | "원산지 판별" 라디오 버튼 선택되어 있음 |
| 2 | TOP 3 CONTRIBUTION | Saponin 65%, Sugar moiety 25%, Aglycone 10% 바 차트 |
| 3 | QUICK ANALYSIS | HIGH 배지 / SCORE 96 / SIMILARITY 0.94 |

#### 동작 5 — AI 실시간 해석 (20초) ★ 신규 기능

우측 패널을 더 아래로 스크롤하면 **AI 해석** 섹션이 보입니다.

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | **AI 해석 (GROQ LLM ANALYSIS)** 영역까지 스크롤 | 4개 항목이 표시됨 |
| 2 | 각 항목 확인 | (초록) 신뢰도 평가 / (파랑) 생리활성 의의 / (보라) 원산지 기여도 / 한줄요약 |
| 3 | 중앙에서 **Decursin** 클릭 | AI 해석이 **"AI 해석 생성 중..."** 로딩 → 새 내용으로 갱신 |

**시연 팁**: 로딩 중(2~3초) "성분을 선택할 때마다 AI가 실시간으로 해석을 생성합니다"라고 나레이션하면 자연스럽습니다.

**트러블슈팅**: AI 해석이 "GROQ_API_KEY가 설정되지 않았습니다" 에러를 보이면 `config/settings.py`의 `GROQ_API_KEY` 값을 확인하세요.

---

### Scene 4. 대국민 포털 전환 (15초)

**이동 방법** (택 1):
- 브라우저 뒤로가기 2번 → 랜딩페이지 → **PUBLIC PORTAL** 클릭
- 또는 주소창에 직접 `http://127.0.0.1:6321/public/` 입력

**URL**: `http://127.0.0.1:6321/public/`

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 대상별 카드 빠르게 보여줌 | 소비자 / 농업인 / 지자체 카드 |
| 2 | **작목 상세 대시보드** 카드 클릭 | **ACTIVE** 배지가 있는 카드 |

---

### Scene 5. 작목 상세 대시보드 — 핵심 시연 (1분 30초)

**URL**: `http://127.0.0.1:6321/public/dashboard/`

페이지 진입 시 기본 비교: **인삼 vs 황기**

#### 동작 1 — 환경 지표 (20초)

| 순서 | 확인 사항 | 위치 |
|------|-----------|------|
| 1 | 지역: 충남 금산군 | 환경 지표 영역 상단 |
| 2 | 연평균 기온: **12.8°C** | 첫 번째 카드 |
| 3 | 연평균 강수량: **1150mm** | 두 번째 카드 |
| 4 | 토양질 지수: **A등급** | 세 번째 카드 |
| 5 | **"API 기반"** 배지 | 각 카드 하단 파란 배지 — 마우스로 가리키며 강조 |

#### 동작 2 — 차트 확인 (20초)

| 차트 | 위치 | 내용 |
|------|------|------|
| 성분 분포 요약 | 좌측 차트 | 인삼 주요 성분 Score 막대 (파란색) |
| 비교 결과 분석 | 우측 차트 | 인삼(파란) vs 황기(주황) 그룹 막대 |

#### 동작 3 — 비교 대상 변경 (20초)

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 좌측 사이드바 TARGET B 드롭다운에서 **"당귀"** 선택 | 드롭다운 변경 |
| 2 | **"비교 분석 적용"** 버튼 클릭 | 페이지 새로고침 |
| 3 | 차트 확인 | 인삼 vs **당귀**로 차트 갱신됨 |
| 4 | 환경 지표 확인 | 지역 데이터가 변경될 수 있음 |
| 5 | 우측 AI 패널 확인 | 로딩 후 **새로운 비교 해설** 생성됨 |

#### 동작 4 — AI 동적 해설 (30초) ★ 핵심

**우측 패널**을 주목합니다. 페이지 로드 시 자동으로 AI가 해설을 생성합니다.

| 순서 | 영역 | 확인 사항 |
|------|------|-----------|
| 1 | 패널 헤더 | **"GROQ LLM 기반 동적 생성"** 배지 확인 |
| 2 | AI 해설 콘텐츠 | 파란 박스: 두 작물 비교 요약 (AI가 생성한 텍스트) |
| 3 | 환경 영향 분석 | 초록 박스: 환경이 성분에 미치는 영향 |
| 4 | 활용 시나리오 | 정책 / 산업 / 농업인 — AI가 맞춤 생성한 인사이트 |
| 5 | 불확실성 안내 | 노란 박스: 데이터 한계 안내 |

**시연 팁**: "이 해설은 하드코딩이 아니라 Groq LLM이 실시간으로 생성한 것입니다. 비교 작물을 바꾸면 해설도 달라집니다"라고 강조하세요.

**로딩 중일 때**: 파란 스피너와 "AI 해설 생성 중..." 텍스트가 보입니다. 이 동안 나레이션을 합니다.

**에러 시**: "다시 시도" 버튼이 표시됩니다. 클릭하면 재요청됩니다.

그 후 아래로 스크롤하여:
- 대국민 산출물 미리보기 카드 보여주기
- OUTPUT DOWNLOADS 버튼 영역 보여주기

---

### Scene 6. AI 챗봇 시연 (30초) ★ 신규 기능

**어느 페이지에서든 가능** (대시보드에서 이어서 해도 OK)

| 순서 | 동작 | 화면 변화 |
|------|------|-----------|
| 1 | 우하단 **파란색 원형 버튼** 클릭 | 채팅 패널이 올라옴 |
| 2 | 초기 메시지 확인 | "안녕하세요! 특용작물 대사체..." 환영 메시지 |
| 3 | 입력창에 타이핑: **"인삼과 황기의 주요 성분 차이는?"** | 입력 중 모습 |
| 4 | **전송** 버튼 클릭 (또는 Enter) | 내 메시지(파란 말풍선) + "답변 생성 중..."(회색) |
| 5 | 2~3초 후 AI 답변 표시 | 회색 말풍선으로 한국어 답변 |
| 6 | 추가 질문: **"Ginsenoside Rg1의 생리활성은?"** → 전송 | 대화가 이어지는 것 확인 |
| 7 | 파란 버튼 다시 클릭 (또는 X 버튼) | 채팅 패널 닫힘 |

**추천 질문 예시** (답변 품질이 좋은 것들):
- "인삼의 주요 성분은?"
- "Decursin의 효능을 알려줘"
- "MSI 레벨이 뭔가요?"
- "금산과 풍기 인삼의 차이는?"
- "사포닌과 쿠마린의 차이점은?"

**컨텍스트 인식**: 챗봇은 현재 페이지를 자동 감지합니다.
- Catalog에서 성분을 선택한 상태로 챗봇을 열면, 선택된 성분 정보가 자동으로 전달됩니다.
- Dashboard에서 열면 비교 중인 작물 정보가 전달됩니다.

---

### Scene 7. 마무리 (30초)

**이동**: 브라우저 주소창에 `http://127.0.0.1:6321/` 입력하여 랜딩페이지로

나레이션을 하며 랜딩페이지를 보여줍니다. 특별한 클릭 동작 없이 화면만 보여주면 됩니다.

---

## 3. 트러블슈팅

### 서버가 안 켜질 때

```bash
# 포트 충돌 확인
lsof -i :6321

# 기존 프로세스 종료
kill $(lsof -i :6321 -t)

# 다시 실행
python manage.py runserver 6321
```

### AI 기능이 작동하지 않을 때

**증상**: "GROQ_API_KEY가 설정되지 않았습니다" 에러

**해결**:
```bash
# 방법 1: 환경변수로 설정
export GROQ_API_KEY="gsk_여기에키입력"
python manage.py runserver 6321

# 방법 2: settings.py에 직접 입력 (이미 설정되어 있을 수 있음)
# config/settings.py → GROQ_API_KEY 값 확인
```

**확인 방법**:
```bash
curl -X POST http://127.0.0.1:6321/api/chat/ \
  -H "Content-Type: application/json" \
  -d '{"messages":[{"role":"user","content":"테스트"}]}'
```
→ `{"role":"assistant","content":"..."}` 응답이 오면 정상

### AI 응답이 느릴 때

Groq 무료 티어는 분당 요청 제한이 있습니다. 짧은 간격으로 여러 번 요청하면 잠시 대기합니다.
- 시연 시 성분을 너무 빠르게 연속 클릭하지 마세요
- 5~10초 간격으로 천천히 클릭하면 안정적입니다

### 데이터가 안 보일 때

```bash
# 시딩 다시 실행
python manage.py seed_data
```

### 외부 터널 끊겼을 때

```bash
# 기존 터널 종료
pkill -f cloudflared

# 다시 실행
nohup cloudflared tunnel --url http://127.0.0.1:6321 > /tmp/cloudflared.log 2>&1 &
sleep 5
grep -oE "https://[a-z0-9-]+\.trycloudflare\.com" /tmp/cloudflared.log | head -1
```

> 재실행 시 URL이 바뀝니다. 새 URL을 공유하세요.

---

## 4. 시연 흐름 요약 (치트시트)

```
[랜딩] 수치카드 호버 → RESEARCH PORTAL 클릭
  ↓
[연구 메인] Quick Stats 확인 → Compound Catalog 클릭
  ↓
[Catalog] 3-컬럼 확인 → 인삼 필터 → 초기화 →
          Rg1 클릭 → 메타/점수 확인 →
          스크롤: TOP3, QUICK ANALYSIS →
          ★ AI 해석 확인 → Decursin 클릭 → AI 갱신
  ↓
[랜딩으로 돌아가기] PUBLIC PORTAL 클릭
  ↓
[공공 메인] 대상 카드 확인 → 작목 대시보드 클릭
  ↓
[Dashboard] 환경 지표 확인 → 차트 확인 →
            TARGET B → 당귀 → 비교 적용 →
            ★ AI 해설 확인 (동적 생성) → 산출물 카드
  ↓
★ [챗봇] 파란 버튼 → 질문 2개 → 닫기
  ↓
[랜딩] 마무리 나레이션
```

총 소요시간: 약 **5분**
